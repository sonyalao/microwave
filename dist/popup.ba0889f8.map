{"version":3,"sources":["popup.js"],"names":["ol","Overlay","Popup","opt_options","options","panMapIfOutOfView","undefined","ani","animation","pan","ani_opts","container","document","createElement","className","closer","href","appendChild","that","addEventListener","evt","style","display","blur","preventDefault","content","call","element","stopEvent","inherits","prototype","show","coord","html","setPosition","innerHTML","window","setTimeout","scrollTop","panIntoView_","popSize","width","getElement","clientWidth","height","clientHeight","mapSize","getMap","getSize","tailHeight","tailOffsetLeft","tailOffsetRight","popOffset","getOffset","popPx","getPixelFromCoordinate","fromLeft","fromRight","fromTop","fromBottom","center","getView","getCenter","px","source","beforeRender","setCenter","getCoordinateFromPixel","hide"],"mappings":"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","file":"popup.ba0889f8.map","sourceRoot":"..","sourcesContent":[" /**\r\n * OpenLayers 3 Popup Overlay.\r\n * See [the examples](./examples) for usage. Styling can be done via CSS.\r\n * @constructor\r\n * @extends {ol.Overlay}\r\n * @param {Object} opt_options Overlay options, extends olx.OverlayOptions adding:\r\n *                              **`panMapIfOutOfView`** `Boolean` - Should the\r\n *                              map be panned so that the popup is entirely\r\n *                              within view.\r\n */\r\nol.Overlay.Popup = function(opt_options) {\r\n\r\n    var options = opt_options || {};\r\n\r\n    this.panMapIfOutOfView = options.panMapIfOutOfView;\r\n    if (this.panMapIfOutOfView === undefined) {\r\n        this.panMapIfOutOfView = true;\r\n    }\r\n\r\n    this.ani = options.ani;\r\n    if (this.ani === undefined) {\r\n        this.ani = ol.animation.pan;\r\n    }\r\n\r\n    this.ani_opts = options.ani_opts;\r\n    if (this.ani_opts === undefined) {\r\n        this.ani_opts = {'duration': 250};\r\n    }\r\n\r\n    this.container = document.createElement('div');\r\n    this.container.className = 'ol-popup';\r\n\r\n    this.closer = document.createElement('a');\r\n    this.closer.className = 'ol-popup-closer';\r\n    this.closer.href = '#';\r\n    this.container.appendChild(this.closer);\r\n\r\n    var that = this;\r\n    this.closer.addEventListener('click', function(evt) {\r\n        that.container.style.display = 'none';\r\n        that.closer.blur();\r\n        evt.preventDefault();\r\n    }, false);\r\n\r\n    this.content = document.createElement('div');\r\n    this.content.className = 'ol-popup-content';\r\n    this.container.appendChild(this.content);\r\n\r\n    ol.Overlay.call(this, {\r\n        element: this.container,\r\n        stopEvent: true\r\n    });\r\n\r\n};\r\n\r\nol.inherits(ol.Overlay.Popup, ol.Overlay);\r\n\r\n/**\r\n * Show the popup.\r\n * @param {ol.Coordinate} coord Where to anchor the popup.\r\n * @param {String} html String of HTML to display within the popup.\r\n */\r\nol.Overlay.Popup.prototype.show = function(coord, html) {\r\n    this.setPosition(coord);\r\n    this.content.innerHTML = html;\r\n    this.container.style.display = 'block';\r\n\r\n    var content = this.content;\r\n    window.setTimeout(function(){\r\n        content.scrollTop = 0;\r\n    }, 100);\r\n    \r\n    if (this.panMapIfOutOfView) {\r\n        this.panIntoView_(coord);\r\n    }\r\n    return this;\r\n};\r\n\r\n/**\r\n * @private\r\n */\r\nol.Overlay.Popup.prototype.panIntoView_ = function(coord) {\r\n\r\n    var popSize = {\r\n            width: this.getElement().clientWidth + 20,\r\n            height: this.getElement().clientHeight + 20\r\n        },\r\n        mapSize = this.getMap().getSize();\r\n\r\n    var tailHeight = 20,\r\n        tailOffsetLeft = 60,\r\n        tailOffsetRight = popSize.width - tailOffsetLeft,\r\n        popOffset = this.getOffset(),\r\n        popPx = this.getMap().getPixelFromCoordinate(coord);\r\n\r\n    var fromLeft = (popPx[0] - tailOffsetLeft),\r\n        fromRight = mapSize[0] - (popPx[0] + tailOffsetRight);\r\n\r\n    var fromTop = popPx[1] - popSize.height + popOffset[1],\r\n        fromBottom = mapSize[1] - (popPx[1] + tailHeight) - popOffset[1];\r\n\r\n    var center = this.getMap().getView().getCenter(),\r\n        px = this.getMap().getPixelFromCoordinate(center);\r\n\r\n    if (fromRight < 0) {\r\n        px[0] -= fromRight;\r\n    } else if (fromLeft < 0) {\r\n        px[0] += fromLeft;\r\n    }\r\n    \r\n    if (fromTop < 0) {\r\n        //px[1] = 170 + fromTop;\r\n        px[1] += fromTop; //original\r\n    } else if (fromBottom < 0) {\r\n        px[1] -= fromBottom;\r\n    }\r\n\r\n    if (this.ani && this.ani_opts) {\r\n        this.ani_opts.source = center;\r\n        this.getMap().beforeRender(this.ani(this.ani_opts));\r\n    }\r\n    this.getMap().getView().setCenter(this.getMap().getCoordinateFromPixel(px));\r\n\r\n    return this.getMap().getView().getCenter();\r\n\r\n};\r\n\r\n/**\r\n * Hide the popup.\r\n */\r\nol.Overlay.Popup.prototype.hide = function() {\r\n    this.container.style.display = 'none';\r\n    return this;\r\n};\r\n"]}